<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paymob Integration Onboarding Planner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6C5CE7;
      --primary-dark: #5B4CFF;
      --primary-light: #A29BFE;
      --secondary: #00D4AA;
      --secondary-dark: #00BF99;
      --accent: #FF6B9D;
      --dark: #0F0F23;
      --dark-secondary: #1A1A2E;
      --text-primary: #2D3436;
      --text-secondary: #636E72;
      --text-muted: #95A5A6;
      --bg-primary: #F8F9FA;
      --bg-secondary: #FFFFFF;
      --bg-gradient: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      --bg-card: #FFFFFF;
      --border: #E1E8ED;
      --border-light: #F1F3F5;
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.04);
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 12px 24px rgba(0, 0, 0, 0.12);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.15);
      --radius: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      font-size: 15px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .header {
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      color: white;
      padding: 1.5rem 0;
      box-shadow: var(--shadow-lg);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-content {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 1rem;
      text-decoration: none;
      transition: var(--transition);
    }
    
    .logo:hover {
      transform: translateY(-2px);
    }
    
    .logo img {
      height: 36px;
      width: auto;
      filter: brightness(0) invert(1);
    }
    
    .logo-text {
      font-size: 1.125rem;
      font-weight: 700;
      color: white;
      letter-spacing: -0.5px;
    }
    
    .header-badge {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      padding: 0.5rem 1.25rem;
      border-radius: 999px;
      font-size: 0.875rem;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .hero {
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      color: white;
      padding: 4rem 2rem 3rem;
      text-align: center;
    }
    
    .hero-content {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .hero-title {
      font-size: 2.75rem;
      font-weight: 800;
      margin-bottom: 1rem;
      line-height: 1.1;
      letter-spacing: -1px;
    }
    
    .hero-subtitle {
      font-size: 1.25rem;
      font-weight: 400;
      opacity: 0.95;
      line-height: 1.6;
      max-width: 650px;
      margin: 0 auto;
    }
    
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 2rem 3rem;
      transform: translateY(-2rem);
    }
    
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-lg);
      padding: 2.5rem;
      margin-bottom: 2rem;
      border: 1px solid var(--border-light);
      transition: var(--transition);
    }
    
    .card:hover {
      box-shadow: var(--shadow-xl);
    }
    
    .card-header {
      margin-bottom: 2rem;
      padding-bottom: 1.25rem;
      border-bottom: 2px solid var(--border-light);
    }
    
    .card-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--dark);
      margin-bottom: 0.5rem;
      letter-spacing: -0.5px;
    }
    
    .card-subtitle {
      font-size: 1rem;
      color: var(--text-secondary);
      font-weight: 400;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 2rem;
    }
    
    .col-12 { grid-column: span 12; }
    .col-8 { grid-column: span 8; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    .col-3 { grid-column: span 3; }
    
    @media (max-width: 768px) {
      .col-8, .col-6, .col-4, .col-3 { grid-column: span 12; }
      .hero-title { font-size: 2rem; }
      .hero-subtitle { font-size: 1.125rem; }
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    label {
      font-weight: 600;
      font-size: 0.9375rem;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .label-badge {
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      color: white;
      padding: 0.125rem 0.625rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .select-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .flag-icon {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 24px;
      pointer-events: none;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .flag-icon img {
      width: 32px;
      height: 24px;
      object-fit: cover;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    select, input[type="text"] {
      width: 100%;
      padding: 1rem 3rem 1rem 1.25rem;
      border: 2px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg-secondary);
      font-family: inherit;
      font-size: 0.9375rem;
      color: var(--text-primary);
      transition: var(--transition);
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23636E72' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
    }
    
    .select-wrapper.with-flag select {
      padding-left: 4rem;
    }
    
    select:hover, input:hover {
      border-color: var(--primary-light);
      background: white;
    }
    
    select:focus, input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(108, 92, 231, 0.1);
      background: white;
    }
    
    select option {
      padding: 0.75rem;
      font-size: 0.9375rem;
    }
    
    .help-text {
      font-size: 0.8125rem;
      color: var(--text-muted);
      line-height: 1.5;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .help-text::before {
      content: "‚ÑπÔ∏è";
      font-size: 0.875rem;
    }
    
    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #F8F9FA 0%, #FFFFFF 100%);
      border-radius: var(--radius-lg);
      border: 2px solid var(--border-light);
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.875rem 1rem;
      background: white;
      border-radius: var(--radius);
      border: 2px solid var(--border-light);
      transition: var(--transition);
      cursor: pointer;
    }
    
    .checkbox-item:hover {
      border-color: var(--primary-light);
      box-shadow: var(--shadow-sm);
      transform: translateY(-2px);
    }
    
    .checkbox-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: var(--primary);
    }
    
    .checkbox-item input[type="checkbox"]:checked + label {
      color: var(--primary);
      font-weight: 600;
    }
    
    .checkbox-item label {
      font-weight: 500;
      font-size: 0.9375rem;
      cursor: pointer;
      color: var(--text-primary);
      flex: 1;
    }
    
    .button-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
    }
    
    button {
      appearance: none;
      border: none;
      border-radius: var(--radius-lg);
      padding: 1rem 2rem;
      font-weight: 600;
      font-size: 0.9375rem;
      cursor: pointer;
      transition: var(--transition);
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      gap: 0.625rem;
      letter-spacing: 0.3px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      color: white;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #764BA2 0%, #667EEA 100%);
      opacity: 0;
      transition: var(--transition);
    }
    
    .btn-primary:hover::before {
      opacity: 1;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .btn-primary span, .btn-primary svg {
      position: relative;
      z-index: 1;
    }
    
    .btn-secondary {
      background: white;
      color: var(--text-primary);
      border: 2px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    
    .btn-secondary:hover {
      border-color: var(--primary);
      color: var(--primary);
      box-shadow: var(--shadow);
      transform: translateY(-2px);
    }
    
    .summary-chips {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    
    .chip {
      padding: 0.75rem 1.25rem;
      background: linear-gradient(135deg, #F8F9FA 0%, #FFFFFF 100%);
      border: 2px solid var(--border-light);
      border-radius: 999px;
      font-size: 0.9375rem;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }
    
    .chip:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }
    
    .chip img {
      width: 24px;
      height: 18px;
      object-fit: cover;
      border-radius: 3px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .roadmap {
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
    }
    
    .stage {
      display: grid;
      grid-template-columns: 56px 1fr;
      gap: 1.5rem;
      align-items: start;
    }
    
    .stage-marker {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 800;
      font-size: 1.25rem;
      box-shadow: var(--shadow-lg);
      position: relative;
    }
    
    .stage-marker::after {
      content: '';
      position: absolute;
      width: 2px;
      height: calc(100% + 2.5rem);
      background: linear-gradient(180deg, var(--primary) 0%, transparent 100%);
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
    }
    
    .stage:last-child .stage-marker::after {
      display: none;
    }
    
    .stage-content {
      background: linear-gradient(135deg, #F8F9FA 0%, #FFFFFF 100%);
      border-radius: var(--radius-lg);
      padding: 1.5rem 2rem;
      border: 2px solid var(--border-light);
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }
    
    .stage-content:hover {
      box-shadow: var(--shadow);
      transform: translateX(4px);
    }
    
    .stage-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--dark);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .stage-title::before {
      content: '';
      width: 4px;
      height: 24px;
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      border-radius: 999px;
    }
    
    .stage-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 0.875rem;
    }
    
    .stage-list li {
      display: flex;
      gap: 1rem;
      color: var(--text-secondary);
      line-height: 1.6;
      font-size: 0.9375rem;
      padding-left: 1rem;
      position: relative;
    }
    
    .stage-list li::before {
      content: "‚Üí";
      color: var(--primary);
      font-weight: 700;
      position: absolute;
      left: 0;
    }
    
    .stage-list li strong {
      color: var(--text-primary);
      font-weight: 600;
    }
    
    .stage-list li a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      transition: var(--transition);
      position: relative;
    }
    
    .stage-list li a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--primary);
      transition: var(--transition);
    }
    
    .stage-list li a:hover::after {
      width: 100%;
    }
    
    .toast {
      font-size: 0.875rem;
      color: var(--text-muted);
      font-style: italic;
      padding: 0.5rem 1rem;
      background: var(--bg-primary);
      border-radius: var(--radius);
      transition: var(--transition);
    }
    
    .toast:not(:empty) {
      background: linear-gradient(135deg, #00D4AA 0%, #00BF99 100%);
      color: white;
      font-style: normal;
      font-weight: 600;
      box-shadow: var(--shadow);
    }
    
    .divider {
      height: 2px;
      background: linear-gradient(90deg, transparent 0%, var(--border-light) 50%, transparent 100%);
      margin: 2rem 0;
    }
    
    .hidden {
      display: none !important;
    }
    
    .footer-note {
      margin-top: 2rem;
      padding: 1.5rem 2rem;
      background: linear-gradient(135deg, #FFF5F5 0%, #FFF 100%);
      border-radius: var(--radius-lg);
      border: 2px dashed var(--border);
      text-align: center;
      color: var(--text-secondary);
      font-size: 0.9375rem;
      line-height: 1.6;
    }
    
    details {
      background: var(--bg-primary);
      border: 2px solid var(--border-light);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      margin-top: 1rem;
      transition: var(--transition);
    }
    
    details:hover {
      border-color: var(--primary-light);
    }
    
    summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--dark);
      user-select: none;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    summary::before {
      content: '‚ñ∂';
      transition: var(--transition);
      color: var(--primary);
    }
    
    details[open] summary::before {
      transform: rotate(90deg);
    }
    
    summary:hover {
      color: var(--primary);
    }
    
    details[open] summary {
      margin-bottom: 1.25rem;
    }
    
    pre {
      background: var(--dark);
      color: #E1E8ED;
      padding: 1.5rem;
      border-radius: var(--radius);
      overflow-x: auto;
      font-size: 0.8125rem;
      line-height: 1.6;
      font-family: 'Courier New', Courier, monospace;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .card {
      animation: fadeIn 0.5s ease-out;
    }
    
    ::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--bg-primary);
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
      border-radius: 999px;
      border: 2px solid var(--bg-primary);
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #764BA2 0%, #667EEA 100%);
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <a href="https://developers.paymob.com" class="logo">
        <img src="https://theneo-prod-public.s3.amazonaws.com/images-1698827834063.svg" alt="Paymob" />
        <span class="logo-text">Developer Portal</span>
      </a>
      <div class="header-badge">Integration Planner</div>
    </div>
  </header>

  <section class="hero">
    <div class="hero-content">
      <h1 class="hero-title">Integration Onboarding Planner</h1>
      <p class="hero-subtitle">
        Get a personalized roadmap tailored to your business needs. We'll guide you through every step with direct links to the documentation you need.
      </p>
    </div>
  </section>

  <div class="container" id="app">
    <section class="card">
      <div class="card-header">
        <h2 class="card-title">Configure Your Integration</h2>
        <p class="card-subtitle">Tell us about your needs so we can create the perfect roadmap for you</p>
      </div>

      <div class="form-grid">
        <div class="col-4 form-group">
          <label for="persona">
            Who are you?
            <span class="label-badge">Required</span>
          </label>
          <select id="persona">
            <option value="merchant">Merchant (non-technical)</option>
            <option value="developer">Developer / Engineer</option>
          </select>
          <span class="help-text">This personalizes your experience</span>
        </div>

        <div class="col-4 form-group">
          <label for="country">
            Region / Country
            <span class="label-badge">Required</span>
          </label>
          <div class="select-wrapper with-flag">
            <span class="flag-icon" id="flagIcon"></span>
            <select id="country"></select>
          </div>
          <span class="help-text">Affects payment methods and settlement</span>
        </div>

        <div class="col-4 form-group">
          <label for="platform">
            Integration Path
            <span class="label-badge">Required</span>
          </label>
          <select id="platform"></select>
          <span class="help-text">Options adapt to your role</span>
        </div>

        <div class="col-6 form-group" id="merchantFields">
          <label for="storefront">Your E-Commerce Platform</label>
          <select id="storefront">
            <option value="none">No online store yet</option>
            <option value="shopify">Shopify</option>
            <option value="woocommerce">WooCommerce</option>
            <option value="magento">Magento</option>
            <option value="opencart">OpenCart</option>
            <option value="prestashop">PrestaShop</option>
            <option value="odoo">Odoo</option>
          </select>
          <span class="help-text">Plugin guides with screenshots</span>
        </div>

        <div class="col-3 form-group hidden" id="devBackend">
          <label for="backend">Backend Language</label>
          <select id="backend"></select>
          <span class="help-text">For API examples</span>
        </div>

        <div class="col-3 form-group hidden" id="devSdk">
          <label for="sdk">Client SDK / Platform</label>
          <select id="sdk">
            <option value="web">Web (Unified Checkout)</option>
            <option value="ios">iOS</option>
            <option value="android">Android</option>
            <option value="flutter">Flutter</option>
            <option value="reactnative">React Native</option>
          </select>
          <span class="help-text">Mobile platform</span>
        </div>

        <div class="col-12 form-group">
          <label>Payment Features & Requirements</label>
          <div class="checkbox-group" id="features"></div>
          <span class="help-text" id="featureHints">Select all features you need</span>
        </div>
      </div>

      <div class="divider"></div>
      <div class="button-group">
        <button class="btn-primary" id="generate">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
          <span>Generate Roadmap</span>
        </button>
        <button class="btn-secondary" id="copy">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
          <span>Copy Markdown</span>
        </button>
        <button class="btn-secondary" id="export">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
          </svg>
          <span>Export JSON</span>
        </button>
        <button class="btn-secondary" id="share">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
          </svg>
          <span>Share URL</span>
        </button>
        <span class="toast" id="toast"></span>
      </div>
    </section>

    <section class="card" id="output">
      <div class="card-header">
        <h2 class="card-title">Your Personalized Integration Roadmap</h2>
        <p class="card-subtitle">Follow these steps in order for a smooth integration</p>
      </div>

      <div class="summary-chips" id="summaryChips"></div>
      <div class="divider"></div>
      <div class="roadmap" id="plan"></div>

      <div class="footer-note">
        üí° <strong>Pro Tip:</strong> You can update your configuration above and regenerate the roadmap at any time. All documentation links are region-specific and always up-to-date.
      </div>
    </section>

    <section class="card">
      <div class="card-header">
        <h3 class="card-title">Developer Tools</h3>
        <p class="card-subtitle">Configuration and testing for maintainers</p>
      </div>
      <details>
        <summary>View Configuration JSON</summary>
        <pre id="configDump"></pre>
      </details>
      <details>
        <summary>Run Self-Tests</summary>
        <pre id="testLog" style="background: var(--bg-primary); color: var(--text-primary); border: 2px solid var(--border);"></pre>
      </details>
    </section>
  </div>

  <script>
  const CONFIG = {
    version: "3.0.0",
    baseUrl: "https://developers.paymob.com",
    storageKey: "paymob_onboarding_v3",
    
    regions: {
      UAE: {
        label: "United Arab Emirates",
        flagUrl: "https://flagcdn.com/w80/ae.png",
        slug: "uae",
        routes: {
          gettingStarted: "/uae/getting-started-uae",
          dashboard: "/uae/accept-dashboard",
          profile: "/uae/accept-dashboard/profile",
          paymentIntegrations: "/uae/accept-dashboard/payment-integrations",
          orders: "/uae/accept-dashboard/orders",
          transactions: "/uae/accept-dashboard/transactions",
          checkoutCustomization: "/uae/accept-dashboard/checkout-customization-1",
          apiBasics: "/uae/api-reference-guide/basics-of-api",
          apiSetup: "/uae/api-reference-guide/api-setup-secret-and-public-key",
          unifiedIntention: "/uae/api-reference-guide/create-intention-payment-api",
          pixel: "/uae/api-reference-guide/pixel",
          splitPayment: "/uae/api-reference-guide/split-feature",
          testCredentials: "/uae/test-credentials-1",
          subscriptions: "/uae/subscriptions",
          subscriptionAuth: "/uae/subscriptions/authentication-request-generate-token",
          createSubscriptionPlan: "/uae/subscriptions/create-subscription-plan",
          paymentLinks: "/uae/payment-links",
          quickLink: "/uae/payment-links/payment-link-quick-link",
          paymentLinkAPI: "/uae/payment-links/payment-link-api",
          threeDSecure: "/uae/payment-types/3ds",
          authCapture: "/uae/payment-types/auth-and-capture",
          cardVerification: "/uae/payment-types/card-verifcation",
          savedToken: "/uae/payment-types/pay-with-saved-token-moto",
          refundAPI: "/uae/payment-actions/api-level/refund-transaction",
          voidAPI: "/uae/payment-actions/api-level/void-transaction-through-api",
          captureAPI: "/uae/payment-actions/api-level/auth-capture-payments",
          transactionInquiry: "/uae/retrieve-a-transaction-inquiry-with-order-id-copy-1",
          callbacks: "/uae/manage-callback/transaction-callbacks-copy",
          hmac: "/uae/manage-callback/hmac-calculation-copy",
          faqs: "/uae/faqs-latest-1/faqs-latest",
          troubleshooting: "/uae/faqs-latest-1/troubleshooting-latest-copy-1",
          plugins: {
            shopify: "/uae/e-commerce-plugins/shopify",
            woocommerce: "/uae/e-commerce-plugins/wordpress-woocommerce",
            wooPrerequisites: "/uae/e-commerce-plugins/wordpress-woocommerce/prerequisites-before-installation-of-plugin-copy-2",
            wooInstall: "/uae/e-commerce-plugins/wordpress-woocommerce/steps-to-install-the-paymob-plugin-copy-2",
            wooConfig: "/uae/e-commerce-plugins/wordpress-woocommerce/setting-up-the-main-configuration-copy-2",
            wooPaymentMethods: "/uae/e-commerce-plugins/wordpress-woocommerce/payment-method-integration-settings-copy-2",
            wooCardEmbedded: "/uae/e-commerce-plugins/wordpress-woocommerce/card-embedded-settings",
            wooSubscription: "/uae/e-commerce-plugins/wordpress-woocommerce/woocommerce-subscription",
            opencart: "/uae/e-commerce-plugins/opencart",
            magento: "/uae/e-commerce-plugins/magento",
            odoo: "/uae/e-commerce-plugins/odoo-4",
            prestashop: "/uae/e-commerce-plugins/prestashop",
            newShopify: "/uae/e-commerce-plugins/new-shopify-app-embedded-checkout"
          },
          sdks: {
            ios: "/uae/mobile-sdks/mobile-sdks-v2/ios-sdk",
            android: "/uae/mobile-sdks/mobile-sdks-v2/android-sdk-1",
            flutter: "/uae/mobile-sdks/mobile-sdks-v2/flutter-sdk",
            reactnative: "/uae/mobile-sdks/mobile-sdks-v2/react-native-sdk"
          },
          paymentMethods: {
            card: "/uae/payment-methods-copy-1/card",
            tabby: "/uae/payment-methods-copy-1/tabby-4",
            tamara: "/uae/payment-methods-copy-1/tamara-3",
            applePay: "/uae/payment-methods-copy-1/apple-pay-3",
            googlePay: "/uae/payment-methods-copy-1/google-pay-1"
          }
        }
      },
      EGYPT: {
        label: "Egypt",
        flagUrl: "https://flagcdn.com/w80/eg.png",
        slug: "egypt",
        routes: {
          gettingStarted: "/egypt/getting-started",
          dashboard: "/egypt/accept-dashboard"
        }
      },
      KSA: {
        label: "Saudi Arabia",
        flagUrl: "https://flagcdn.com/w80/sa.png",
        slug: "ksa",
        routes: {
          gettingStarted: "/ksa/getting-started",
          dashboard: "/ksa/accept-dashboard"
        }
      },
      OMAN: {
        label: "Oman",
        flagUrl: "https://flagcdn.com/w80/om.png",
        slug: "oman",
        routes: {
          gettingStarted: "/oman/getting-started",
          dashboard: "/oman/accept-dashboard"
        }
      },
      PAKISTAN: {
        label: "Pakistan",
        flagUrl: "https://flagcdn.com/w80/pk.png",
        slug: "pakistan",
        routes: {
          gettingStarted: "/pakistan/getting-started",
          dashboard: "/pakistan/accept-dashboard"
        }
      }
    },
    
    integrationPaths: {
      merchant: ["merchant_plugin", "merchant_paymentlink", "merchant_dashboard"],
      developer: ["custom_web", "mobile_sdk", "dev_paymentlink"]
    },
    
    backends: {
      none: { label: "Not applicable", route: null },
      nodejs: { label: "Node.js", route: "/examples/nodejs" },
      python: { label: "Python", route: "/examples/python" },
      php: { label: "PHP", route: "/examples/php" },
      java: { label: "Java", route: "/examples/java" },
      dotnet: { label: ".NET (C#)", route: "/examples/dotnet" },
      ruby: { label: "Ruby", route: "/examples/ruby" }
    },
    
    features: [
      { id: "cards", label: "Card Payments", persona: "both" },
      { id: "wallets", label: "Apple Pay / Google Pay", persona: "both" },
      { id: "bnpl", label: "Buy Now Pay Later (Tabby/Tamara)", persona: "both" },
      { id: "subscriptions", label: "Recurring Payments / Subscriptions", persona: "both" },
      { id: "split", label: "Split Payments", persona: "developer" },
      { id: "authcapture", label: "Auth & Capture", persona: "both" },
      { id: "refunds", label: "Refunds", persona: "both" },
      { id: "savedcards", label: "Save Card for Future Use", persona: "both" },
      { id: "3ds", label: "3D Secure", persona: "developer" },
      { id: "callbacks", label: "Webhooks / Callbacks", persona: "developer" }
    ]
  };
  
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));
  
  function route(country, key) {
    const region = CONFIG.regions[country];
    if (!region || !region.routes) return '#';
    const path = region.routes[key];
    return path ? CONFIG.baseUrl + path : '#';
  }
  
  function link(text, path, external = false) {
    if (!path || path === '#') return text;
    const href = path.startsWith('http') ? path : CONFIG.baseUrl + path;
    return `<a href="${href}"${external ? ' target="_blank" rel="noopener"' : ''}>${text}</a>`;
  }
  
  function pluginLine(storefront, country) {
    const plugins = CONFIG.regions[country]?.routes?.plugins || {};
    const pluginMap = {
      shopify: { key: 'shopify', name: 'Shopify' },
      woocommerce: { key: 'woocommerce', name: 'WooCommerce' },
      magento: { key: 'magento', name: 'Magento' },
      opencart: { key: 'opencart', name: 'OpenCart' },
      prestashop: { key: 'prestashop', name: 'PrestaShop' },
      odoo: { key: 'odoo', name: 'Odoo' }
    };
    
    const plugin = pluginMap[storefront];
    if (!plugin) return 'Follow plugin documentation';
    return link(`${plugin.name} Plugin Guide`, plugins[plugin.key], true);
  }
  
  function saveState(state) {
    localStorage.setItem(CONFIG.storageKey, JSON.stringify(state));
  }
  
  function loadState() {
    try {
      return JSON.parse(localStorage.getItem(CONFIG.storageKey) || '{}');
    } catch {
      return {};
    }
  }
  
  function shareUrl(state) {
    const params = new URLSearchParams(state);
    if (state.features) params.set('features', state.features.join(','));
    return `${location.origin}${location.pathname}?${params.toString()}`;
  }
  
  function updateFlagDisplay() {
    const country = countrySel.value;
    const flagUrl = CONFIG.regions[country]?.flagUrl;
    const flagIcon = $('#flagIcon');
    
    if (flagUrl) {
      flagIcon.innerHTML = `<img src="${flagUrl}" alt="${country} flag" />`;
    } else {
      flagIcon.innerHTML = '';
    }
  }
  
  const personaSel = $('#persona');
  const countrySel = $('#country');
  const platformSel = $('#platform');
  const storefrontSel = $('#storefront');
  const backendSel = $('#backend');
  const sdkSel = $('#sdk');
  const featuresDiv = $('#features');
  const chipsDiv = $('#summaryChips');
  const planDiv = $('#plan');
  const merchantFields = $('#merchantFields');
  const devBackend = $('#devBackend');
  const devSdk = $('#devSdk');
  
  function hydrateForm() {
    Object.entries(CONFIG.regions).forEach(([code, region]) => {
      const opt = document.createElement('option');
      opt.value = code;
      opt.textContent = region.label;
      countrySel.appendChild(opt);
    });
    
    Object.entries(CONFIG.backends).forEach(([code, backend]) => {
      const opt = document.createElement('option');
      opt.value = code;
      opt.textContent = backend.label;
      backendSel.appendChild(opt);
    });
    
    CONFIG.features.forEach(feature => {
      const div = document.createElement('div');
      div.className = 'checkbox-item';
      div.innerHTML = `
        <input type="checkbox" id="feature-${feature.id}" value="${feature.id}" data-persona="${feature.persona}">
        <label for="feature-${feature.id}">${feature.label}</label>
      `;
      featuresDiv.appendChild(div);
    });
  }
  
  function refreshPersonaUI() {
    const persona = personaSel.value;
    const ismerchant = persona === 'merchant';
    
    merchantFields.classList.toggle('hidden', !ismerchant);
    devBackend.classList.toggle('hidden', ismerchant);
    devSdk.classList.toggle('hidden', ismerchant);
    
    const paths = CONFIG.integrationPaths[persona] || [];
    platformSel.innerHTML = '';
    
    const options = {
      merchant_plugin: 'E-commerce Plugin',
      merchant_paymentlink: 'Payment Links',
      merchant_dashboard: 'Dashboard Only',
      custom_web: 'Custom Web Integration (API)',
      mobile_sdk: 'Mobile App SDK',
      dev_paymentlink: 'Payment Links API'
    };
    
    paths.forEach(path => {
      const opt = document.createElement('option');
      opt.value = path;
      opt.textContent = options[path] || path;
      platformSel.appendChild(opt);
    });
    
    $$('#features input[type="checkbox"]').forEach(cb => {
      const featurePersona = cb.dataset.persona;
      const parentDiv = cb.closest('.checkbox-item');
      if (featurePersona === 'developer' && ismerchant) {
        parentDiv.style.display = 'none';
        cb.checked = false;
      } else {
        parentDiv.style.display = '';
      }
    });
  }
  
  function getStateFromUI() {
    const features = $$('#features input:checked').map(cb => cb.value);
    return {
      persona: personaSel.value,
      country: countrySel.value,
      platform: platformSel.value,
      storefront: storefrontSel.value,
      backend: backendSel.value,
      sdk: sdkSel.value,
      features
    };
  }
  
  function applyStateToUI(state) {
    personaSel.value = state.persona || 'merchant';
    countrySel.value = state.country || 'UAE';
    platformSel.value = state.platform || 'merchant_plugin';
    storefrontSel.value = state.storefront || 'shopify';
    backendSel.value = state.backend || 'none';
    sdkSel.value = state.sdk || 'web';
    
    $$('#features input[type="checkbox"]').forEach(cb => {
      cb.checked = (state.features || []).includes(cb.value);
    });
    
    updateFlagDisplay();
  }
  
  function autoSelectRelated() {
    const features = $$('#features input:checked').map(cb => cb.value);
    const cbMap = {};
    $$('#features input[type="checkbox"]').forEach(cb => cbMap[cb.value] = cb);
    
    if (features.includes('subscriptions') && cbMap.cards && !cbMap.cards.checked) {
      cbMap.cards.checked = true;
    }
    if (features.includes('authcapture') && cbMap.cards && !cbMap.cards.checked) {
      cbMap.cards.checked = true;
    }
  }
  
  function setFeatureHints() {
    const hints = $('#featureHints');
    const platform = platformSel.value;
    const storefront = storefrontSel.value;
    
    if (platform === 'merchant_plugin' && storefront !== 'none') {
      hints.textContent = `${storefront} plugin supports most features out-of-the-box`;
    } else if (platform === 'custom_web') {
      hints.textContent = 'API integration gives you full control';
    } else {
      hints.textContent = 'Select all features you need';
    }
  }
  
  function buildPlan(state) {
    const steps = [];
    const { persona, country, platform, storefront, backend, sdk, features } = state;
    const isMerchant = persona === 'merchant';
    
    const accountItems = [
      `Sign up at ${link('Paymob Portal', 'https://uae.paymob.com/portal2/en/register', true)}`,
      'Complete KYC verification (business documents, ID)',
      `Access your dashboard and review ${link('Getting Started Guide', route(country, 'gettingStarted'), true)}`,
      'Verify test mode is enabled for development'
    ];
    steps.push(stage('Account Setup & Verification', accountItems, 1));
    
    const integrationItems = [];
    if (isMerchant && platform === 'merchant_plugin' && storefront !== 'none') {
      integrationItems.push(
        `Install ${pluginLine(storefront, country)}`,
        `Locate API keys: Dashboard ‚Üí ${link('Settings ‚Üí Account Info', route(country, 'profile'), true)}`,
        'Copy Public Key, Secret Key, and Integration IDs',
        `Configure plugin with ${link('step-by-step screenshots', CONFIG.regions[country]?.routes?.plugins?.wooConfig || '#', true)}`
      );
    } else if (platform === 'custom_web') {
      integrationItems.push(
        `Read ${link('API Basics', route(country, 'apiBasics'), true)} to understand authentication`,
        `Generate API keys from ${link('Dashboard Settings', route(country, 'apiSetup'), true)}`,
        `Review ${link('Unified Intention API', route(country, 'unifiedIntention'), true)} for payment flow`,
        backend !== 'none' ? `Use ${CONFIG.backends[backend]?.label} SDK/examples` : 'Choose your backend language'
      );
    } else if (platform === 'mobile_sdk') {
      integrationItems.push(
        `Download and install ${link(sdk === 'ios' ? 'iOS SDK' : sdk === 'android' ? 'Android SDK' : `${sdk} SDK`, CONFIG.regions[country]?.routes?.sdks?.[sdk] || '#', true)}`,
        `Get API keys from ${link('Dashboard', route(country, 'apiSetup'), true)}`,
        'Initialize SDK with your keys',
        'Configure SDK for test mode first'
      );
    } else if (platform === 'merchant_paymentlink' || platform === 'dev_paymentlink') {
      integrationItems.push(
        `Learn about ${link('Payment Links', route(country, 'paymentLinks'), true)}`,
        platform === 'merchant_paymentlink' 
          ? `Create ${link('Quick Links', route(country, 'quickLink'), true)} from dashboard`
          : `Use ${link('Payment Link API', route(country, 'paymentLinkAPI'), true)} to generate links programmatically`,
        'Configure link parameters (amount, currency, customer info)',
        'Test with sandbox credentials'
      );
    } else {
      integrationItems.push(
        'Access dashboard to manage payments',
        'No technical integration required',
        'Use manual payment entry features'
      );
    }
    steps.push(stage('Choose & Configure Integration', integrationItems, 2));
    
    const paymentItems = [
      features.includes('cards') ? `Enable ${link('Card Payments', CONFIG.regions[country]?.routes?.paymentMethods?.card || '#', true)} (Visa, Mastercard)` : null,
      features.includes('wallets') ? `Set up ${link('Apple Pay', CONFIG.regions[country]?.routes?.paymentMethods?.applePay || '#', true)} and ${link('Google Pay', CONFIG.regions[country]?.routes?.paymentMethods?.googlePay || '#', true)}` : null,
      features.includes('bnpl') ? `Configure ${link('Tabby', CONFIG.regions[country]?.routes?.paymentMethods?.tabby || '#', true)} and ${link('Tamara', CONFIG.regions[country]?.routes?.paymentMethods?.tamara || '#', true)} BNPL` : null,
      features.includes('3ds') ? `Implement ${link('3D Secure authentication', route(country, 'threeDSecure'), true)}` : null,
      `Review ${link('Test Credentials', route(country, 'testCredentials'), true)} for each method`
    ].filter(Boolean);
    
    if (paymentItems.length === 0) {
      paymentItems.push('Select payment features above to see specific setup steps');
    }
    
    steps.push(stage('Payment Methods Configuration', paymentItems, 3));
    
    const featureItems = [];
    if (features.includes('subscriptions')) {
      featureItems.push(`Set up ${link('Recurring Subscriptions', route(country, 'subscriptions'), true)} with plan management`);
    }
    if (features.includes('authcapture')) {
      featureItems.push(`Implement ${link('Auth & Capture', route(country, 'authCapture'), true)} for hold-and-charge flow`);
    }
    if (features.includes('refunds')) {
      featureItems.push(`Configure ${link('Refund API', route(country, 'refundAPI'), true)} or use dashboard refunds`);
    }
    if (features.includes('savedcards')) {
      featureItems.push(`Enable ${link('Card Tokenization', route(country, 'savedToken'), true)} for repeat customers`);
    }
    if (features.includes('callbacks')) {
      featureItems.push(`Set up ${link('Webhooks', route(country, 'callbacks'), true)} for payment notifications`);
      featureItems.push(`Implement ${link('HMAC validation', route(country, 'hmac'), true)} for security`);
    }
    if (features.includes('split')) {
      featureItems.push(`Configure ${link('Split Payments', route(country, 'splitPayment'), true)} for marketplace`);
    }
    
    if (featureItems.length === 0) {
      featureItems.push('Basic payment flow is ready');
      featureItems.push('Add advanced features as needed from the dashboard');
    }
    
    steps.push(stage('Advanced Features & Customization', featureItems, 4));
    
    const testItems = [
      'Test all payment flows with test cards',
      'Verify success, decline, and 3DS scenarios',
      features.includes('callbacks') ? 'Test webhook delivery and processing' : null,
      features.includes('refunds') ? 'Test refund/void operations' : null,
      `Use ${link('Transaction Inquiry API', route(country, 'transactionInquiry'), true)} to verify payment status`,
      `Check ${link('Troubleshooting Guide', route(country, 'troubleshooting'), true)} if issues arise`
    ].filter(Boolean);
    steps.push(stage('Testing & QA', testItems, 5));
    
    const goLiveItems = [
      'Switch from TEST to LIVE mode in dashboard',
      'Replace test API keys with production keys',
      'Verify production webhook URLs are correct',
      features.includes('wallets') ? 'Complete Apple Pay / Google Pay domain verification' : null,
      'Monitor first transactions closely',
      `Review ${link('FAQs', route(country, 'faqs'), true)} for common production issues`,
      'Contact support@paymob.com if needed'
    ].filter(Boolean);
    steps.push(stage('Go Live Checklist', goLiveItems, 6));
    
    return steps;
  }
  
  function stage(title, items, number) {
    const html = `
      <div class="stage">
        <div class="stage-marker">${number}</div>
        <div class="stage-content">
          <h3 class="stage-title">${title}</h3>
          <ul class="stage-list">
            ${items.map(item => `<li>${item}</li>`).join('')}
          </ul>
        </div>
      </div>
    `;
    return { title, html, number };
  }
  
  function renderPlan(steps, state) {
    chipsDiv.innerHTML = '';
    const regionInfo = CONFIG.regions[state.country];
    
    const chips = [
      { text: state.persona === 'merchant' ? 'üë§ Merchant' : 'üíª Developer', hasFlag: false },
      { text: regionInfo?.label || state.country, flagUrl: regionInfo?.flagUrl, hasFlag: true },
      { 
        text: state.persona === 'merchant' 
          ? (state.storefront === 'none' ? 'üì¶ No store' : `üõçÔ∏è ${state.storefront}`)
          : (state.platform === 'custom_web' ? `‚öôÔ∏è ${CONFIG.backends[state.backend]?.label || 'API'}` : `üì± ${state.sdk}`),
        hasFlag: false
      }
    ];
    
    if (state.features.length > 0) {
      chips.push({ text: `‚ú® ${state.features.length} features`, hasFlag: false });
    }
    
    chips.forEach(chipData => {
      const chip = document.createElement('div');
      chip.className = 'chip';
      
      if (chipData.hasFlag && chipData.flagUrl) {
        chip.innerHTML = `<img src="${chipData.flagUrl}" alt="flag" /> ${chipData.text}`;
      } else {
        chip.textContent = chipData.text;
      }
      
      chipsDiv.appendChild(chip);
    });
    
    planDiv.innerHTML = steps.map(s => s.html).join('');
  }
  
  function toMarkdown(steps) {
    return steps.map((s, i) => 
      `## ${s.number}. ${s.title}\n\n${extractLiText(s.html).map(li => `- ${li}`).join('\n')}\n`
    ).join('\n');
  }
  
  function extractLiText(html) {
    const el = document.createElement('div');
    el.innerHTML = html;
    return Array.from(el.querySelectorAll('li')).map(li => li.textContent.trim().replace(/^‚Üí\s*/, ''));
  }
  
  function toast(msg) {
    const t = $('#toast');
    t.textContent = msg;
    setTimeout(() => t.textContent = '', 3000);
  }
  
  hydrateForm();
  
  const params = new URLSearchParams(location.search);
  const saved = loadState();
  const initial = {
    persona: params.get('persona') || saved.persona || 'merchant',
    country: params.get('country') || saved.country || 'UAE',
    platform: params.get('platform') || saved.platform || 'merchant_plugin',
    storefront: params.get('storefront') || saved.storefront || 'shopify',
    backend: params.get('backend') || saved.backend || 'none',
    sdk: params.get('sdk') || saved.sdk || 'web',
    features: params.get('features') ? params.get('features').split(',').filter(Boolean) : (saved.features || [])
  };
  
  applyStateToUI(initial);
  refreshPersonaUI();
  autoSelectRelated();
  setFeatureHints();
  const initialState = getStateFromUI();
  renderPlan(buildPlan(initialState), initialState);
  
  personaSel.addEventListener('change', () => {
    refreshPersonaUI();
    autoSelectRelated();
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
    setFeatureHints();
  });
  
  countrySel.addEventListener('change', () => {
    updateFlagDisplay();
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
  });
  
  platformSel.addEventListener('change', () => {
    setFeatureHints();
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
  });
  
  storefrontSel.addEventListener('change', () => {
    setFeatureHints();
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
  });
  
  backendSel.addEventListener('change', () => {
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
  });
  
  sdkSel.addEventListener('change', () => {
    const s = getStateFromUI();
    saveState(s);
    renderPlan(buildPlan(s), s);
  });
  
  $$('#features input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', () => {
      autoSelectRelated();
      const s = getStateFromUI();
      saveState(s);
      renderPlan(buildPlan(s), s);
    });
  });
  
  $('#generate').addEventListener('click', (e) => {
    e.preventDefault();
    autoSelectRelated();
    const state = getStateFromUI();
    saveState(state);
    renderPlan(buildPlan(state), state);
    toast('‚úì Roadmap generated successfully!');
  });
  
  $('#copy').addEventListener('click', async (e) => {
    e.preventDefault();
    try {
      const state = getStateFromUI();
      const md = toMarkdown(buildPlan(state));
      await navigator.clipboard.writeText(md);
      toast('‚úì Copied to clipboard!');
    } catch (err) {
      toast('‚úó Copy failed - check permissions');
    }
  });
  
  $('#export').addEventListener('click', (e) => {
    e.preventDefault();
    const state = getStateFromUI();
    const payload = {
      state,
      steps: buildPlan(state).map(s => ({ title: s.title, items: extractLiText(s.html) })),
      configVersion: CONFIG.version,
      exportedAt: new Date().toISOString()
    };
    const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `paymob_integration_plan_${Date.now()}.json`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    toast('‚úì Plan exported successfully!');
  });
  
  $('#share').addEventListener('click', async (e) => {
    e.preventDefault();
    const state = getStateFromUI();
    const url = shareUrl(state);
    try {
      await navigator.clipboard.writeText(url);
      toast('‚úì Share URL copied!');
    } catch {
      toast(url);
    }
  });
  
  $('#configDump').textContent = JSON.stringify(CONFIG, null, 2);
  
  (function runTests() {
    const log = (msg, ok = true) => {
      const pre = $('#testLog');
      const line = document.createElement('div');
      line.style.color = ok ? '#00D4AA' : '#FF6B9D';
      line.textContent = (ok ? '‚úì ' : '‚úó ') + msg;
      pre.appendChild(line);
    };
    
    try {
      log('Configuration loaded', !!CONFIG.version);
      log('Regions defined', Object.keys(CONFIG.regions).length > 0);
      log('UAE routes available', !!CONFIG.regions.UAE?.routes);
      log('buildPlan function works', typeof buildPlan === 'function');
      const testPlan = buildPlan({ persona: 'merchant', country: 'UAE', platform: 'merchant_plugin', storefront: 'shopify', backend: 'none', sdk: 'web', features: [] });
      log('Sample plan generated', Array.isArray(testPlan) && testPlan.length > 0);
      log('Country flags configured', !!CONFIG.regions.UAE?.flagUrl);
      log('Flag display functional', !!$('#flagIcon'));
    } catch (e) {
      log('Tests failed: ' + e.message, false);
    }
  })();
  </script>
</body>
</html>
